services:
  graindl:
    build:
      context: .
      args:
        VERSION: ${VERSION:-dev}
        COMMIT: ${COMMIT:-none}
    restart: unless-stopped
    volumes:
      - ./recordings:/data
      - ./.env:/home/exporter/.env:ro
    environment:
      - GRAIN_API_TOKEN
    deploy:
      resources:
        limits:
          memory: 2G
          cpus: '1.0'
    security_opt:
      - seccomp:unconfined  # Replace with chrome.json seccomp profile for production
    # Override command for browser / watch mode:
    # command: ["--output", "/data", "--headless", "--watch", "--log-format", "json"]
